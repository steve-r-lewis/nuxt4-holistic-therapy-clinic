# @monorepo/theme-manager

The `@monorepo/theme-manager` layer manages visual theming and presentation configuration. It integrates with `ui-library` for consistent styling. Authentication, authorisation, domain logic, scheduling, logistics, inventory, and membership are handled elsewhere.

## üé® Theme Manager Layer

## 1\. Overview

This directory contains the theme manager layer for the Nuxt application. It's built on Tailwind CSS v4 and designed to create a highly abstract, dynamic, and maintainable theming system.

The entire architecture is built on a simple philosophy: **separate the *recipe* from the *menu*, and let Tailwind be the *kitchen*.**

Our components don't care *what* color "primary" is; they just ask for it. This means we can change the entire theme (e.g., from "Fresh" to "Ocean") or swap between light and dark modes, and all components will update automatically.

## 2\. The Theming Cascade

The architecture works on a three-layer abstraction model. This is the most important concept to grasp.

1.  **Layer 1: The Recipe (`theme-default.css`)**
    This file defines the raw "ingredients" (the hex codes). It provides a complete, independent, fallback theme. It contains *no aliases*‚Äîjust pure values for every single token in both light and dark modes (e.g., `--ui-fill-primary-default-light: #94b99d;`).

2.  **Layer 2: The Menu (`theme-api.css`)**
    This is the core abstraction layer. It maps the raw "recipe" ingredients to stable, *semantic* names (e.g., `--api-fill-primary-default`). This file is the *only* place that knows about light vs. dark mode. It uses `:root` for light mode mappings and `html.dark` for dark mode mappings.

3.  **Layer 3: The Kitchen (`tailwind-config.css`)**
    This file tells the Tailwind engine to "cook" the "menu" items. It uses `@theme inline` to map our stable `--api-*` variables into Tailwind's `color-*` namespace (e.g., `--color-fill-primary-default: var(--api-fill-primary-default);`). This is what *generates* the final utility classes.

### Visual Flow

```
[ theme-default.css ]         [ theme-api.css ]                  [ tailwind-config.css ]            [ Tailwind Engine ]       [ components/buttons.css ]
 (Raw "Recipe")              (Semantic "Menu")                  (Tailwind "Kitchen")               (Class Generation)        (Component Styling)
---------------------       ---------------------              ----------------------             ------------------        --------------------------
--ui-fill-primary-default-light: #94b99d;
                            ->  --api-fill-primary-default:
                                  var(--ui-fill-primary-default-light);
                                                             ->  --color-fill-primary-default:
                                                                   var(--api-fill-primary-default);
                                                                                              ->  .bg-fill-primary-default { ... }
                                                                                                                        ->  .btn-primary {
                                                                                                                              @apply bg-fill-primary-default;
                                                                                                                            }
```

## 3\. How to Use

### The `fill / pen / edge` Grammar

You should *never* use hard-coded colors (e.g., `bg-red-500`). Instead, you use the semantic utilities generated by this system. The grammar is simple:

* **`fill-*`**: For background colors (e.g., `bg-fill-primary-default`).
* **`pen-*`**: For foreground content, like text and icons (e.g., `text-pen-base-default`).
* **`edge-*`**: For border colors (e.g., `border-edge-input-default`).

### The State Model

The grammar above is combined with a 6-part state model:

| State | CSS / Trigger | Duration | Purpose |
| :--- | :--- | :--- | :--- |
| **`default`** | (none) | Persistent | The resting state of a component. |
| **`hover`** | `:hover` | Ephemeral | When a user's mouse is over the component. |
| **`active`** | `:active` | Milliseconds | The *event* of a user pressing down. |
| **`selected`** | `.router-link-active` / `.is-selected` | Persistent | The *state* of a component being "on" or "current." |
| **`visited`** | `:visited` | Persistent | Browser-tracked state for links. |
| **`disabled`** | `:disabled` | Persistent | The component is not interactive. |

This is the key: **`active` is the *click*, `selected` is the *result*.**

### Example: Styling a Component

```css
/* * ‚ùå BAD: Not theme-aware.
 */
.my-button-bad {
  @apply bg-green-600 text-white border-green-700;
  @apply hover:bg-green-700 active:bg-green-800;
}

/* * ‚úÖ GOOD: Fully theme-aware and semantic.
 * This button will automatically adapt to light mode, dark mode, 
 * and any future theme you create.
 */
.my-button-good {
  /* Use the default fill, pen, and edge colors */
  @apply bg-fill-primary-default text-pen-base-default;
  @apply border border-edge-primary-default;

  /* Let Tailwind handle the state variants */
  @apply hover:bg-fill-primary-hover hover:border-edge-primary-hover;
  @apply active:bg-fill-primary-active active:border-edge-primary-active;
  @apply disabled:bg-fill-base-disabled disabled:text-pen-base-disabled;
}
```

## 4\. File Structure

* `main.css`: The central CSS entry point. It imports Tailwind and all other layers in the correct order.
* `theme/theme-default.css`: The "recipe." Provides fallback theme values.
* `theme/theme-api.css`: The "menu." Maps raw values to semantic API variables.
* `tailwindcss/tailwind-config.css`: The "kitchen." Generates Tailwind utilities from the API.
* `components/components.css`: An importer that loads all individual component files.
* `components/*.css`: Your component library (e.g., `buttons.css`, `cards.css`, `navbars.css`).

## 5\. How to Add New Tokens

To add a new color (e.g., for a "brand" button):

1.  **Add the Recipe:** Add `--ui-fill-brand-default-light`, `--ui-fill-brand-default-dark`, and all its state variations to `theme-default.css`.
2.  **Add to the Menu:** Map the new variables in `theme-api.css` (e.g., `--api-fill-brand-default: var(--ui-fill-brand-default-light);`).
3.  **Tell the Kitchen:** Add the new mappings to `tailwind-config.css` (e.g., `--color-fill-brand-default: var(--api-fill-brand-default);`).

You can now use `bg-fill-brand-default` in any component.

---
